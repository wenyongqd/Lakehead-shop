{"version":3,"sources":["uni-app:///main.js",null,"webpack:////Users/hewenyong/IdeaProjects/wechat/lakehead-shop/pages/login/login.vue?ff71","webpack:////Users/hewenyong/IdeaProjects/wechat/lakehead-shop/pages/login/login.vue?5007","webpack:////Users/hewenyong/IdeaProjects/wechat/lakehead-shop/pages/login/login.vue?501c","uni-app:///pages/login/login.vue","webpack:////Users/hewenyong/IdeaProjects/wechat/lakehead-shop/pages/login/login.vue?0c7b","webpack:////Users/hewenyong/IdeaProjects/wechat/lakehead-shop/pages/login/login.vue?dab3"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,4F;AACAA,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACa;;;AAGjE;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAm0B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACkFv1B,+C;;;;AAIA;AACA;AACA;AACA;AAFA,GADA;AAKA,MALA,kBAKA;AACA;AACA,mBADA;AAEA,kBAFA;AAGA,kBAHA;AAIA,qBAJA;AAKA,eALA;AAMA,cANA;AAOA,iBAPA;AAQA,oBARA;;AAUA,GAhBA;AAiBA,QAjBA,oBAiBA;;AAEA,GAnBA;AAoBA;AACA,YADA,sBACA;AACA;AACA;AACA;AACA;AACA,KANA,EApBA;;AA4BA;AACA,6CADA;AAEA,eAFA,uBAEA,CAFA,EAEA;AACA;AACA;AACA,KALA;AAMA,cANA,wBAMA;AACA;AACA;AACA,wBAHA;;AAKA,cALA;;AAOA,UAPA,CAKA,QALA,CAMA,QANA,GAOA,IAPA,CAMA,QANA;AAQA;AACA;AACA;AACA,yDADA;AAEA;AACA,4BADA;AAEA,4BAFA,EAFA;;AAMA,sBANA;AAOA,uBAPA;AAQA,wBARA;AASA;AACA;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;AACA,SAhBA;AAiBA;AACA;AACA,SAnBA;;AAqBA,KArCA;AAsCA;AACA;AACA;AACA,mDADA;AAEA;AACA,+DADA,EAFA;;AAKA;AACA,+BADA;AAEA,+BAFA;AAGA,kCAHA;AAIA,+BAJA;AAKA,mCALA,EALA;;AAYA,wBAZA;AAaA,yBAbA;AAcA,0BAdA;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAJA,MAIA;AACA;AACA;AACA,WAzBA;AA0BA;AACA;AACA,WA5BA;;AA8BA,OA/BA;AAgCA,KAvEA;AAwEA,QAxEA,kBAwEA;AACA;AACA,gBADA;;AAGA,KA5EA;AA6EA;AACA,YA9EA,sBA8EA;AACA;AACA;AACA;AACA;AACA,KAnFA;AAoFA;AACA,gBArFA,0BAqFA;AACA;AACA;AACA;AACA,KAzFA;AA0FA;AACA,WA3FA,qBA2FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBADA;AAEA;AACA,oBADA,EAFA;AAIA,UAJA,CAIA;AACA;AACA,6BADA;AAEA,sBAFA;;AAIA;AACA;AACA;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;AACA;AACA,SAPA,EAOA,IAPA;AAQA,OAnBA;AAoBA,KAvHA;AAwHA;AACA,YAzHA,sBAyHA;AACA;AACA;AACA;AACA;AACA,2BADA;AAEA,sBAFA;;AAIA;AACA;AACA;AACA;AACA,KArIA;AAsIA;AACA,UAvIA,oBAuIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BADA;AAEA,yBAFA;;AAIA,OARA,MAQA;AACA;AACA;AACA;AACA,iCADA;AAEA,iCAFA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBADA;;AAGA;AACA,uBADA;AAEA,sBAFA;;AAIA,OAfA,EAeA,KAfA,CAeA;AACA;AACA;AACA,OAlBA;;AAoBA,KAjLA;AAkLA;AACA;AACA;AACA;AACA;AACA,kDADA;AAEA;AACA,0CADA,EAFA;;AAKA,uBALA;AAMA,yBANA;AAOA,0BAPA;AAQA;AACA;AACA;AACA;AACA;AACA,aAHA,MAGA;AACA;AACA,2BADA;;AAGA;AACA,WAlBA;AAmBA;AACA;AACA,WArBA;;AAuBA,OA1BA;AA2BA,KA9MA;AA+MA,aA/MA,uBA+MA;AACA;AACA;AACA;AACA;AACA,UADA,CACA;AACA;AACA;AACA,OAJA;AAKA,UALA,CAKA;AACA;AACA;AACA;AACA,OATA;AAUA,KA7NA;;AA+NA,UA/NA,kBA+NA,QA/NA,EA+NA;AACA;AACA;;;;AAIA;AACA;AACA,6BADA;;AAGA,OAJA,MAIA;AACA;AACA;;AAEA,KA7OA;AA8OA,gBA9OA,0BA8OA;AACA;;;;AAIA;AACA,KApPA;AAqPA;AACA;AACA;;;AAGA;AACA,yBADA;AAEA;AACA;AACA;AACA,WALA;AAMA;AACA;AACA,WARA;;AAUA;AACA,OAfA;AAgBA,KAtQA;AAuQA;AACA;AACA;AACA;AACA;AACA,kBADA,IACA,WADA,GACA,IADA,GACA,gCAFA;AAGA;AACA;AACA;AACA;AACA,WAPA;AAQA;AACA;AACA,iCADA;;AAGA,WAZA;;AAcA,OAfA;AAgBA,KAzRA;AA0RA;AACA;AACA;AACA,4BADA;AAEA;AACA;AACA;AACA,WALA;AAMA;AACA;AACA,gCADA;;AAGA,WAVA;;AAYA,OAbA;AAcA,KAzSA;AA0SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDADA;AAEA;AACA,sBADA;AAEA,0BAFA;AAGA,0BAHA,EAFA;;AAOA,wBAPA;AAQA,yBARA;AASA,0BATA;AAUA;AACA;AACA;AACA;AACA,+BADA;;AAGA,aAJA,MAIA;AACA;AACA,+BADA;;AAGA;AACA,WArBA;AAsBA;AACA;AACA,WAxBA;;AA0BA,OA/BA;AAgCA,KA3UA;AA4UA;AACA;;;AAGA;AACA;AACA,UADA,CACA;AACA;AACA;AACA,OAJA;AAKA,UALA,CAKA;AACA;AACA;AACA,OARA;AASA,UATA,CASA;AACA;AACA,OAXA;AAYA,UAZA,CAYA;AACA;AACA;AACA,OAfA;AAgBA,UAhBA,CAgBA;AACA;AACA,OAlBA;AAmBA,UAnBA,CAmBA;AACA;AACA;AACA;AACA,OAvBA;;AAyBA,KA1WA,GA5BA,E;;;;;;;;;;;;;ACtFA;AAAA;AAAA;AAAA;AAAgrC,CAAgB,gmCAAG,EAAC,C;;;;;;;;;;;ACApsC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/login/login.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/login/login.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./login.vue?vue&type=template&id=b237504c&\"\nvar renderjs\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/login/login.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=template&id=b237504c&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<!-- #ifndef MP -->\r\n\t\t<uni-status-bar></uni-status-bar>\r\n\t\t<view>\r\n\t\t\t<view class=\"iconfont icon-guanbi flex align-center justify-center font-lg\" style=\"width: 100rpx;height: 100rpx;\"\r\n\t\t\t hover-class=\"bg-light\" @click=\"back\"></view>\r\n\t\t</view>\r\n\t\t<!-- #endif -->\r\n\r\n\t\t<view class=\"text-center\" style=\"padding-top: 30rpx;padding-bottom: 70rpx;font-size: 55rpx;\">{{status ? '手机验证码登录':'Login'}}</view>\r\n\r\n\t\t<view class=\"px-2\">\r\n\t\t\t<template v-if=\"!status\">\r\n\t\t\t\t<view class=\"mb-2\">\r\n\t\t\t\t\t<input type=\"text\" v-model=\"username\" placeholder=\"Id/Phone number/Email\" class=\"border-bottom p-2\" @input=\"inputChange\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"mb-2 flex align-stretch\">\r\n\t\t\t\t\t<input type=\"text\" v-model=\"password\" placeholder=\"Please inout password\" class=\"border-bottom p-2 flex-1\" @input=\"inputChange\"\r\n\t\t\t\t\t @confirm=\"toLogin\" />\r\n\t\t\t\t\t<view class=\"border-bottom flex align-center justify-center font text-muted\" style=\"width: 250rpx;\">Forget\r\n\t\t\t\t\t\tpassword?</view>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\r\n\t\t\t<template v-else>\r\n\t\t\t\t<view class=\"mb-2 flex align-stretch\">\r\n\t\t\t\t\t<view class=\"border-bottom flex align-center justify-center font px-2\">+86</view>\r\n\t\t\t\t\t<input type=\"text\" v-model=\"phone\" placeholder=\"手机号\" class=\"border-bottom p-2 flex-1\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"mb-2 flex align-stretch\">\r\n\t\t\t\t\t<input type=\"text\" v-model=\"code\" placeholder=\"请输入验证码\" class=\"border-bottom p-2 flex-1\" />\r\n\t\t\t\t\t<view class=\"border-bottom flex align-center justify-center font-sm text-white\" :class=\"codeTime > 0 ? 'bg-main-disabled' : 'bg-main'\"\r\n\t\t\t\t\t style=\"width: 180rpx;\" @click=\"getCode\">{{codeTime > 0 ? codeTime + ' s' : '获取验证码'}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\r\n\r\n\t\t</view>\r\n\r\n\t\t<view class=\"py-2 px-3\">\r\n\t\t\t<button class=\"text-white\" style=\"border-radius: 50rpx;border: 0;\" type=\"primary\" :disabled=\"disabled\" :class=\"disabled ? 'bg-main-disabled':'bg-main'\"\r\n\t\t\t @click=\"nameLogin\" :loading=\"loading\">{{loading ? 'Logining...' : 'Login'}}</button>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"py-2 px-3\">\r\n\t\t\t<button class=\"text-white\" style=\"border-radius: 50rpx;border: 0;\" type=\"primary\" :disabled=\"disabled\" :class=\"disabled ? 'bg-main-disabled':'bg-main'\"\r\n\t\t\t @click=\"nameRegist\" :loading=\"loading\">{{loading ? 'Logining...' : 'Register'}}</button>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"flex align-center justify-center pt-2 pb-4\">\r\n\t\t\t<view class=\"text-primary font-sm\" @click=\"changeStatus\">\r\n\t\t\t\t{{status?'账号密码登录':'Login with SMS verification'}}\r\n\t\t\t</view>\r\n\t\t\t<text class=\"text-muted mx-2\">|</text>\r\n\t\t\t<view class=\"text-primary font-sm\">Forget password?</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"flex align-center justify-center\">\r\n\t\t\t<view style=\"height: 1rpx;background-color: #dddddd;width: 100rpx;\"></view>\r\n\t\t\t<view class=\"mx-2 text-muted\">Login with other account</view>\r\n\t\t\t<view style=\"height: 1rpx;background-color: #dddddd;width: 100rpx;\"></view>\r\n\t\t</view>\r\n\t\t<!-- 微信 -->\r\n\t\t<view class=\"oauth-row\">\r\n\t\t\t<view class=\"oauth-image\">\r\n\t\t\t\t<image src=\"/static/weixin.png\" @click=\"oauth('weixin')\"></image>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<other-login back></other-login>\r\n\r\n\t\t<view class=\"flex align-center justify-center text-muted size\" style=\"margin-top: 70rpx;\">\r\n\t\t\tBy registing means agree<text class=\"text-primary size\">《Lakehead Community License》</text>\r\n\t\t</view>\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport uniStatusBar from '@/components/uni-ui/uni-status-bar/uni-status-bar.vue';\r\n\t// import otherLogin from '@/components/common/other-login.vue';\r\n\timport {\r\n\t\tmapMutations\r\n\t} from 'vuex';\r\n\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tuniStatusBar,\r\n\t\t\t// otherLogin\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tstatus: false,\r\n\t\t\t\tusername: \"\",\r\n\t\t\t\tpassword: \"\",\r\n\t\t\t\tlogining: false,\r\n\t\t\t\tphone: \"\",\r\n\t\t\t\tcode: \"\",\r\n\t\t\t\tcodeTime: 0,\r\n\t\t\t\tloading: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tdisabled() {\r\n\t\t\t\tif ((this.username === '' || this.password === '') && (this.phone === '' || this.code === '')) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t...mapMutations(['login', 'token']),\r\n\t\t\tinputChange(e) {\r\n\t\t\t\tconst key = e.currentTarget.dataset.key;\r\n\t\t\t\tthis[key] = e.detail.value;\r\n\t\t\t},\r\n\t\t\tnameRegist() {\r\n\t\t\t\t/* 数据合法性校验 */\r\n\t\t\t\t/* if() */\r\n\t\t\t\tconsole.log(\"注册\")\r\n\t\t\t\tconst {\r\n\t\t\t\t\tusername,\r\n\t\t\t\t\tpassword\r\n\t\t\t\t} = this;\r\n\t\t\t\tconsole.log(this.username)\r\n\t\t\t\tconsole.log(this.password)\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: \"http://3.96.104.51:53020/uaa/register/name\",\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tusername,\r\n\t\t\t\t\t\tpassword\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\ttimeout: 100000,\r\n\t\t\t\t\tdataType: \"json\",\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tconsole.log(res.data.message);\r\n\t\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\t\tthis.$api.msg(res.data.message)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$api.msg(res.data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(e) {\r\n\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tnamelogin: (user_name, pass_word) => {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: \"http://3.96.104.51:53020/uaa/login\",\r\n\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t\"Content-type\": \"application/x-www-form-urlencoded\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tusername: user_name,\r\n\t\t\t\t\t\t\tpassword: pass_word,\r\n\t\t\t\t\t\t\tgrant_type: \"password\",\r\n\t\t\t\t\t\t\tclient_id: \"CAMPUS\",\r\n\t\t\t\t\t\t\tclient_secret: \"SECRET\",\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\t\ttimeout: 100000,\r\n\t\t\t\t\t\tdataType: \"json\",\r\n\t\t\t\t\t\tsuccess: (infoRes) => {\r\n\t\t\t\t\t\t\t/* infoRes = JSON.parse(res) */\r\n\t\t\t\t\t\t\tconsole.log(\"login res: \" + infoRes.data)\r\n\t\t\t\t\t\t\tif (infoRes.data.access_token != null) {\r\n\t\t\t\t\t\t\t\tuni.setStorageSync(\"jwt\", infoRes.data.access_token);\r\n\t\t\t\t\t\t\t\tconsole.log(\"===login success===\")\r\n\t\t\t\t\t\t\t\tresolve(infoRes.data.access_token);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treject(infoRes.data.error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(e) {\r\n\t\t\t\t\t\t\treject(infoRes.data.error)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tback() {\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta: 1\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 初始化表单\r\n\t\t\tinitForm() {\r\n\t\t\t\tthis.username = ''\r\n\t\t\t\tthis.password = ''\r\n\t\t\t\tthis.phone = ''\r\n\t\t\t\tthis.code = ''\r\n\t\t\t},\r\n\t\t\t// 切换登录方式\r\n\t\t\tchangeStatus() {\r\n\t\t\t\t// 初始化表单\r\n\t\t\t\tthis.initForm()\r\n\t\t\t\tthis.status = !this.status\r\n\t\t\t},\r\n\t\t\t// 获取验证码\r\n\t\t\tgetCode() {\r\n\t\t\t\t// 防止重复获取\r\n\t\t\t\tif (this.codeTime > 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// 验证手机号\r\n\t\t\t\tif (!this.validate()) return;\r\n\t\t\t\t// 请求数据\r\n\t\t\t\tthis.$H.post('/user/sendcode', {\r\n\t\t\t\t\tphone: this.phone\r\n\t\t\t\t}, {\r\n\t\t\t\t\tnative: true\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.data.msg,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// 倒计时\r\n\t\t\t\t\tthis.codeTime = 60\r\n\t\t\t\t\tlet timer = setInterval(() => {\r\n\t\t\t\t\t\tif (this.codeTime >= 1) {\r\n\t\t\t\t\t\t\tthis.codeTime--\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.codeTime = 0\r\n\t\t\t\t\t\t\tclearInterval(timer)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 表单验证\r\n\t\t\tvalidate() {\r\n\t\t\t\t//手机号正则\r\n\t\t\t\tvar mPattern = /^1[34578]\\d{9}$/;\r\n\t\t\t\tif (!mPattern.test(this.phone)) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '手机号格式不正确',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\t// ...更多验证\r\n\t\t\t\treturn true\r\n\t\t\t},\r\n\t\t\t// 提交\r\n\t\t\tsubmit() {\r\n\t\t\t\t// 表单验证\r\n\t\t\t\tlet url = \"\"\r\n\t\t\t\tlet data = \"\"\r\n\t\t\t\tif (this.status) {\r\n\t\t\t\t\t// 手机验证码登录\r\n\t\t\t\t\tif (!this.validate()) return;\r\n\t\t\t\t\turl = '/user/phonelogin'\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\tphone: this.phone,\r\n\t\t\t\t\t\tcode: this.code\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 账号密码登录\r\n\t\t\t\t\turl = '/user/login'\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\tusername: this.username,\r\n\t\t\t\t\t\tpassword: this.password\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// 提交后端\r\n\t\t\t\tthis.loading = true\r\n\t\t\t\tthis.$H.post(url, data).then(res => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t// 修改vuex的state,持久化存储\r\n\t\t\t\t\tthis.$store.commit('login', res)\r\n\t\t\t\t\t// 开启socket\r\n\t\t\t\t\tthis.$store.dispatch('openSocket')\r\n\t\t\t\t\t// 提示和跳转\r\n\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\tdelta: 1\r\n\t\t\t\t\t});\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t// 登录失败\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t})\r\n\r\n\t\t\t},\r\n\t\t\tgetinfo: (token) => {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tlet jwt = (token == undefined ? uni.getStorageSync(\"jwt\") : token);\r\n\t\t\t\t\tconsole.log(\"jwt: \" + jwt);\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: \"http://3.96.104.51:53020/uaa/info\",\r\n\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\tAuthorization: \"Bearer \" + jwt\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmethod: \"GET\",\r\n\t\t\t\t\t\ttimeout: 100000,\r\n\t\t\t\t\t\tdataType: \"json\",\r\n\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\t\t\tuni.setStorageSync(\"userInfo\", res.data.data)\r\n\t\t\t\t\t\t\t\tresolve(res.data.data)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: \"失败\"\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(e) {\r\n\t\t\t\t\t\t\treject(res.data.message)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tnameLogin() {\r\n\t\t\t\t/* 数据验证模块*/\r\n\t\t\t\tconsole.log(\"登陆\")\r\n\t\t\t\tthis.logining = true;\r\n\t\t\t\tthis.namelogin(this.username, this.password)\r\n\t\t\t\t\t.then((token) => {\r\n\t\t\t\t\t\tthis.token(token);\r\n\t\t\t\t\t\tthis.getinfo(token)\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\tthis.login(res);\r\n\t\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\ttoMain(userName) {\r\n\t\t\t\tthis.login(userName);\r\n\t\t\t\t/**\r\n\t\t\t\t * 强制登录时使用reLaunch方式跳转过来\r\n\t\t\t\t * 返回首页也使用reLaunch方式\r\n\t\t\t\t */\r\n\t\t\t\tif (this.forcedLogin) {\r\n\t\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\t\turl: '../main/main',\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tinitPosition() {\r\n\t\t\t\t/**\r\n\t\t\t\t * 使用 absolute 定位，并且设置 bottom 值进行定位。软键盘弹出时，底部会因为窗口变化而被顶上来。\r\n\t\t\t\t * 反向使用 top 进行定位，可以避免此问题。\r\n\t\t\t\t */\r\n\t\t\t\tthis.positionTop = uni.getSystemInfoSync().windowHeight - 100;\r\n\t\t\t},\r\n\t\t\tgetWeixinAccess: (value) => {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tconsole.log(\"获取微信信息\")\n\t\t\n\r\n\t\t\t\t\tuni.login({\r\n\t\t\t\t\t\tprovider: value,\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\tresolve(res.code);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t})\n\t\t\t\t\tconsole.log(\"获取微信信息2\")\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetOpenId: (code) => {\r\n\t\t\t\tconsole.log(\"code: \" + code)\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: \"https://api.weixin.qq.com/sns/jscode2session?appid=\" + uni.getStorageSync(\"appid\") + \"&secret=\" + uni.getStorageSync(\r\n\t\t\t\t\t\t\t\"secret\") + \"&js_code=\" + code + \"&grant_type=authorization_code\",\r\n\t\t\t\t\t\tsuccess: (info_res) => {\r\n\t\t\t\t\t\t\tconsole.log(\"openId: \" + info_res.data.openid)\r\n\t\t\t\t\t\t\tuni.setStorageSync(\"openId\", info_res.data.openid);\r\n\t\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(e) {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: \"获取openId失败\"\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetWxInfo: () => {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.getUserInfo({\r\n\t\t\t\t\t\tprovider: \"weixin\",\r\n\t\t\t\t\t\tsuccess: (infoRes) => {\r\n\t\t\t\t\t\t\tuni.setStorageSync(\"nickName\", infoRes.userInfo.nickName);\r\n\t\t\t\t\t\t\tuni.setStorageSync(\"avatarUrl\", infoRes.userInfo.avatarUrl);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(e) {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: \"微信第三方登陆失败\"\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\twxRegisterRequest: () => {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tlet id = uni.getStorageSync(\"openId\");\r\n\t\t\t\t\tlet name = uni.getStorageSync(\"nickName\");\r\n\t\t\t\t\tlet url = uni.getStorageSync(\"avatarUrl\");\r\n\t\t\t\t\t/* console.log(id + \" \" + name + \" \" + url) */\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: \"http://3.96.104.51:53020/uaa/register/wx\",\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\topenId: id,\r\n\t\t\t\t\t\t\tnickName: name,\r\n\t\t\t\t\t\t\tavatarUrl: url\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\t\ttimeout: 100000,\r\n\t\t\t\t\t\tdataType: \"json\",\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\tif (res.data.code == 0 || res.data.code == 2) {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: \"微信授权成功\"\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: \"微信授权失败\"\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(e) {\r\n\t\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\toauth: function(value) {\r\n\t\t\t\t/* uni.showLoading({\r\n\t\t\t\t\ttitle: \"授权登录中...\"\r\n\t\t\t\t}) */\n\t\t\t\tconsole.log(\"进来啦进来啦进来啦进来啦进来啦\")\r\n\t\t\t\tthis.getWeixinAccess(value)\r\n\t\t\t\t\t.then((code) => {\n\t\t\t\t\t\tconsole.log(\"获取微信信息0\")\r\n\t\t\t\t\t\tthis.getOpenId(code)\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tthis.getWxInfo()\n\t\t\t\t\t\tconsole.log(\"获取微信信息3\")\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tthis.wxRegisterRequest()\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tlet id = uni.getStorageSync(\"openId\");\r\n\t\t\t\t\t\tthis.namelogin(id, id)\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then((token) => {\r\n\t\t\t\t\t\tthis.getinfo(token)\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\tthis.login(res);\r\n\t\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t\t})\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.size {\r\n\t\tfont-size: 12px;\r\n\t}\r\n\r\n\t.oauth-row {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: center;\r\n\t\tposition: absolute;\r\n\r\n\t\tleft: 0px;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.oauth-image {\r\n\t\tposition: relative;\r\n\t\twidth: 50px;\r\n\t\theight: 50px;\r\n\t\tborder: 1px solid #dddddd;\r\n\t\tborder-radius: 50px;\r\n\t\tmargin: 0 20px;\r\n\t\tbackground-color: #ffffff;\r\n\t}\r\n\r\n\t.oauth-image image {\r\n\t\tposition: absolute;\r\n\t\ttop: 0px;\r\n\t\twidth: 30px;\r\n\t\theight: 30px;\r\n\t\tmargin: 10px;\r\n\t}\r\n\r\n\t.oauth-image button {\r\n\t\tposition: absolute;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\topacity: 0;\r\n\t}\r\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1595731698328\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}